<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<title></title>
	</head>
<body>
	<script src="js/jquery.js" charset="utf-8"></script>
	<script src="../resources/scripts/jquery.cookies.js"></script>
	<script src="../venson/js/common.js"></script>
	<script>		
		if(Comm.isMobile()){
			document.write("<script src='js/dingtalk.js' charset='utf-8'><\/script>");
		}
		else{
			document.write("<script src='https://g.alicdn.com/dingding/dingtalk-pc-api/2.9.0/index.js' charset='utf-8'><\/script>");
		}
	</script>
	<script src="js/resource.js"></script>
	<script type="text/javascript">
		if(window.hasOwnProperty("DingTalkPC")){
			DingTalkPC.runtime.permission.requestAuthCode({
    		    corpId: dd_res.corpId,
    		    onSuccess: function(result) {
    		    	sso(result.code);
    		    },
    		    onFail : function(err) {
    		    	console.log(err);
    		    }
    		}); 
		}
		else{
			dd.ready(function(){
				dd.runtime.permission.requestAuthCode({
	    		    corpId: dd_res.corpId,
	    		    onSuccess: function(result) {
	    		    	sso(result.code);
	    		    },
	    		    onFail : function(err) {
	    		    	console.log(err);
	    		    }
	    		}); 	        	 	
	        });
		}
		
		function sso(code){
			Comm.getData("dingding/sso.do",{"code":code,"_method":"get"});
			console.log(document.cookie);
			var url = Comm.getUrlParam("url");
			url = decodeURIComponent(url);
			console.log(document.cookie);
			location.href = url;
		}
	</script>
</body>
</html>