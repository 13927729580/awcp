<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="org.szcloud.framework.metadesigner.core.domain.ModelRelation">
	<!-- <cache type="org.mybatis.caches.memcached.LoggingMemcachedCache" /> -->
	<resultMap id="rm" type="org.szcloud.framework.metadesigner.core.domain.ModelRelation">
		<id property="id" jdbcType="BIGINT" column="id"/>
		<result property="relationName" jdbcType="VARCHAR" column="relationName"/>
		<result property="relationType" jdbcType="VARCHAR" column="relationType"/>
		<result property="modelId" jdbcType="BIGINT" column="modelId"/>
		<result property="itemId" jdbcType="BIGINT" column="itemId"/>
		<result property="descript" jdbcType="VARCHAR" column="descript"/>
	</resultMap>
	<sql id="relation_sql">
		id,relationName,relationType,modelId,itemId,descript
	</sql>
	
	<select id="findAll" resultMap="rm">
		select <include refid="relation_sql"/> from modelRelation
	</select>
	
	<insert id="insert" useGeneratedKeys="true" keyProperty="id">
		insert into modelRelation(relationName,relationType,modelId,itemId,descript)
		value(#{relationName},#{relationType},#{modelId},#{itemId},#{descript})
	</insert>
	
	<!-- 根据属性查询 -->
	<select id="queryByItem" parameterType="Object" resultMap="rm">
		select <include refid="relation_sql"/> from modelRelation where itemId=#{itemId}
	</select>
	
	<select id="queryByModelId" parameterType="Object" resultMap="rm">
		select <include refid="relation_sql"/> from modelRelation where modelId=#{modelId}
	</select>
	
	<update id="update" parameterType="org.szcloud.framework.metadesigner.core.domain.MetaModelItems">
		UPDATE modelRelation SET
			relationName=#{relationName},
			relationType=#{relationType},
			modelId=#{modelId},
			itemId=#{itemId},
			descript=#{descript}
		WHERE 
			id = #{id} 
	</update>
	<!-- 删除记录 -->
	<delete id="remove" parameterType="Object">
		delete from modelRelation
		where id = #{id}
	</delete>
</mapper>

